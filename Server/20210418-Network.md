## :star: 네트워크

## 스타벅스 가서 아메리카노 마실래

2주차 `Network` 수업은 위의 문장으로 시작한다. `Client`를 고객, `Server`를 스타벅스라고 가정해보자. 그러면 무엇을 먼저 해야 하는가??

### Protocol

고객(`Client`)은 먼저 스타벅스의 위치를 알아야 될 것이며 위치를 찾을 때는 도로명 주소, 지번 주소 등 여러 가지 방법이 있다. 이러한 방법들을 `Protocol` 즉 통신 규약이라고 보면 된다.

- `http` : Hyper Text Transfer Protocol, 웹통신이며 주로 HTML 문서를 주고받는 데 사용
- `https` : http에 Secure Socket이 더해진 프로토콜로 보안이 강화(ssl) 
- `ftp` : File Transfer Protocol, 파일을 전송하는 프로토콜로 현재는 잘 사용하지 않는다.
- `sftp` : ssh(Secure Shell)의 파일 전송 버전

## Port

위치를 알았으면 이제 찾아갈 것이다. 찾아가면 스타벅스에는 문이 여러개 있을 것이다. 정문이 있을 것이고, 또한 후문이 있을 수도 있다. 그리고 스태프들만 이용하는 문도 있을 것이다. 이러한 문들을 `Port`에 비유할 수 있다. 따라서 내부로 들어갈 수 있는 문이 다르다. 이는 프로토콜마다 특정한 포트 번호를 갖고 있음을 의미한다.

- `http` : 80
- `https` : 443
- `ftp` : 21
- `sftp` : 22
- `MySQL` : 3306

참고로 포트 번호는 고정된 숫자가 아니기 때문에 임의로 부여할 수 있다. 하지만 위에서 명시한 포트 번호는 관례적으로 자주 사용함을 알고 있어야 한다.

### 인바운드 규칙

만약 모든 문이 열려있다면 도둑이 스타벅스에 들어가 물건을 훔칠 확률이 높아진다. 따라서 특정 포트를 제외하고는 외부에서 들어올 수 없도록 해야 한다.

### 아웃바운드 규칙

스타벅스 내에서 일하는 직원은 자유롭게 밖으로 나가야 하며 이러한 포트는 열려 있어야 한다.

### Daemon

이렇게 문을 열고 들어가면 고객을 맞이해주는 직원들이 있다. 이것을 통신언어로 `Daemon`이라 한다. 데몬은 백그라운드 프로세스의 일종으로 요청이 발생했을 때 이에 적절한 대응을 취한다.

## 포트포워딩(Port Forwarding)

클라이언트와 서버를 분리하여 외부에서 서버로의 접속을 가능하게 해야 한다. 이를 위해 `Port Forwarding`에 대해 알아야 한다.


![](https://user-images.githubusercontent.com/46131688/104481768-81f5dc00-5609-11eb-9741-8b20d030ded9.png)

위의 사진에서 192.168.0.4 서버에 접속하고 싶으면 어떤 행동을 취해야 할까? 통신사 랜선을 꽂은 공유기는 204.160.234.12라는 고정 IP 주소를 갖는다. 그리고 공유기에 연결된 다수의 컴퓨터도 IP를 할당받는다. 공유기의 주소를 외부 IP, 컴퓨터의 고유한 IP를 내부 IP라고 한다.

### 포트 번호를 통한 접근

이렇게 컴퓨터 서버에 접근하려면 우선 외부 IP를 통해 접근해야 한다. 하지만 외부 IP를 그대로 사용해서는 들어가지 못할 것이다. 그래서 우리는 포트 번호를 이용하여 내부 IP에 접근할 수 있게 된다. 우리가 접근하고자 하는 서버의 포트 번호를 123이라고 가정을 하면 공유기에게 123 포트로 요청이 들어오면 123 포트랑 연결되어있는 IP로 접근이 가능할 것이다. 이것이 바로 `Port Forwarding`이다. 포트포워딩 지정을 해주어야 비로소 외부 클라이언트에서 내부 서버로 접근할 수 있게 된다.


