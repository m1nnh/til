## :star:  SQL BASIC

### :speech_balloon: 관계형 데이터베이스

#### 1. 데이터베이스
- 많은 사용자들은 보다 효율적인 데이터의 관리 뿐만 아니라 예기치 못한 사건으로 인한 데이터의 손상을 피하고, 필요시 필요한 데이터를 복구하기 위한 강력한 기능의 소프트웨어를 필요로 하게 되었고 이러한 기본적인 요구사항을 만족시켜주는 시스템을 DMBS(Database Management System)라고 한다.
- 관계형 데이터베이스(Relational Database)
    - 파일시스템은 분산된 데이터 간의 정합성을 유지하는데 과다한 노력이 필요하게 되고 데이터의 정합성을 보장하기 힘들게 된다.(단, 단일 사용자나 단일 어플리케이션이 파일시스템을 사용하는 경우 데이터베이스보다 처리 성능이 뛰어나므로 특정 업무에서는 아직도 파일시스템을 유용하게 사용하고 있다.)
    - 이러한 문제에 대해 관계형 데이터베이스는 정규화를 통한 합리적인 테이블 모델링을 통해 이상 형산응 제거하고 데이터 중복을 피할 수 있으며, 동시성 관리, 병행 제어를 통해 많은 사용자들이 동시에 데이터를 공유 및 조작할 수 있는 기능을 제공하고 있다.
    - 또한, 관계형 데이터베이스는 메타 데이터를 총괄 관리할 수 있기 때문에 데이터의 성격, 속성 또는 표현 방법 등을 체계화할 수 있고, 데이터 표준화를 통한 데이터 품질을 확보할 수 있는 장점을 가지고 있다.
    - 그리고 DBMS는 인증된 사용자만이 참조할 수 있도록 보안 기능을 제공하고 있다. 테이블 생성 시에 사용할 수 있는 다양한 제약조건을 이용하여 사용자가 실수로 조건에 위배되는 데이터를 입력 한다든지, 관계를 연결하는 중요 데이터를 삭제하는 것을 방지하여 데이터 무결성을 보장할 수 있다.
    - 추가로 DBMS는 시스템의 갑작스런 장애로부터 사용자가 입력, 수정, 삭제하던 데이터가 제대로 반영될 수 있도록 보장해주는 기능과, 시스템 다운, 재해 등의 상황에서도 데이터를 회복/복구할 수 있는 기능을 제공한다.

#### 2. SQL
- SQL(Structured Query Language)은 관계형 데이터베이스에서 데이터 정의, 데이터 조작, 데이터 제어를 하기 위해 사용하는 언어이다.
- SQL 문장은 단순 스크립트가 아니라 이름에도 포함되어 있듯이, 일반적인 개발 언어처럼 독립된 하나의 개발 언어이다. 하지만 일반적인 프로그래밍 언어와는 달리 SQL은 관계형 데이터베이스에 대한 전담 접속 용도로 사용되며 집합 논리에 입각한 것이므로, SQL도 데이터를 집합으로써 취급한다.
- 데이터 조작어(DML(Data Manipulation Language))
    - SELECT : 데이터베이스에 들어 있는 데이터를 조회하거나 검색하기 위한 명령어를 말하는 것으로 Reterieve라고도 한다.
    - INSERT, UPDATE, DELETE : 데이터베이스의 테이블에 들어 있는 데이터에 변형을 가하는 종류의 명령어들을 말한다. 예를 들어 데이터를 테이블에 새로운 행을 집어넣거나, 원하지 않는 데이터를 삭제하거나 수정하는 것들의 명령어들을 DML이라고 부른다.
- 데이터 정의어(DDL(Data Definition Language))
    - CREATE, ALTER, DROP, RENAME : 테이블과 같은 데이터 구조를 정의하는데 사용되는 명령어들로 그러한 구조를 생성하거나 변경하거나 삭제하거나 이름을 바꾸는 데이터 구조와 관련된 명령어들을 DDL이라고 부른다.
- 데이터 제의어(DCL(Data Control Language))
    - GRANT, REVOKE : 데이터베이스에 접근하고 객체들을 사용하도록 권한을 주고 회수하는 명령어를 DCL이라고 부른다.
- 트랜잭션 제의어(TCL(Transaction Control Language))
    - COMMIT, ROLLBACK : 논리적인 작업의 단위를 묶어서 DML에 의해 조작된 결과를 작업단위(트랜잭션) 별로 제어하는 명령어를 말한다.

#### 3. TABLE
- 데이터는 관계형 데이터베이스의 기본 단위인 테이블 형태로 저장된다. 모든 자료는 테이블에 등록이 되고, 우리는 테이블로부터 원하는 자료를 꺼내 올 수 있다.
- 테이블은 데이터를 저장하는 객체로써 관계형 데이터베이스의 기본 단위이다.
- 테이블 관계 용어들
    - 정규화 : 테이블을 분할하여 데이터의 정합성을 확보하고, 불필요한 중복을 줄이는 프로세스
    - 기본키 : 테이블에 존재하는 각 행을 한 가지 의미로 특정할 수 있는 한 개 이상의 칼럼
    - 외부키 : 다른 테이블의 기본키로 사용되고 있는 관계를 연결하는 칼럼

#### 4. ERD
- 팀 정보와 선수 정보 간에는 어떤 의미의 관계가 존재하며, 다른 테이블과도 어떤 의미의 연관성이나 관계를 가지고 있다. ERD는 이와 같은 관계의 의미를 직관적으로 표현할 수 있는 좋은 수단이다.

### :speech_balloon: DDL

#### 1. 데이터 유형
- 자주 쓰이는 데이터 유형
    - CHARACTER(s)
        - 고정 길이 문자열 정보
        - s는 기본 길이 1바이트
        - s만큼 최대 길이를 갖고 고정 길이를 가지고 있으므로 할당 된 변수 값의 길이가 s보다 작을 경우에는 그 차이 길이만큼 공간으로 채워진다.
    - VARCHAR(s)
        - 가변 길이 문자열 정보
        - s는 최소 길이 1바이트
        - s만큼의 최대 길이를 갖지만 가변 길이로 조정이 되기 때문에 할당 된 변수값의 바이트만 적용된다.
    - NUMERIC
        - 정수, 실수 등 숫자 정보
    - DATETIME
        - 날짜와 시각 정보

#### 2. CREATE TABLE
- 테이블 생성을 위해서는 해당 테이블에 입력될 데이터를 정의하고, 정의한 데이터를 어떠한 데이터 유형으로 선언할 것인지를 결정해야 한다.
- 제약조건(CONSTRAINT)의 종류
    - PRIMARY KEY(기본키) : 테이블에 저장된 행 데이터를 고유하게 식별하기 위한 기본키를 정의한다. 하나의 테이블에 하나의 기본키 제약만 정의할 수 있다. 
    - UNIQUE KEY(고유키) : 테이블에 저장된 행 데이터를 고유하게 식별하기 위한 고유키를 정의한다.
    - NOT NULL : NULL 값의 입력을 금지한다. 디폴트 상태에서는 모든 칼럼에서 NULL을 허가하고 있지만, 이 제약을 지정함으로써 해당 칼럼은 입력 필수가 된다.
    - CHECK : 입력할 수 있는 값의 범위 등을 제한한다. CHECK의 제약으로는 TRUE, FALSE로 평가할 수 있는 논리식을 지정한다.
    - FOREIGN KEY(외래키) : 관계형 데이터베이스에서 테이블 간의 관계를 정의하기 위해 기본키를 다른 테이블의 외래키로 복사하는 경우 외래키가 생선된다. 외래키 지정시 참조 무결성 제약 옵션을 선택할 수 있다.
- 생성된 테이블 구조 확인 (DESC 테이블명)

#### 3. ALTER TABLE
- 한 번 생성된 테이블은 특별히 사용자가 구조를 변경하기 전까지 생성 당시의 구조를 유지하게 된다.
- ADD COLUMN : 기존 테이블에 필요한 칼럼을 추가하는 명령이다
    - ex) ALTER TABLE 테이블명 ADD 추가할 칼럼명 데이터명
- DROP COLUMN : 기존 테이블에서 필요없는 칼럼을 삭제하는 명렁어이다.
    - ex) ALTER TABLE 테이블명 DROP COLUMN 삭제할 칼럼명
- MODIFY COLUMN : 테이블에 존재하는 칼럼에 대해서 ALTER TABLE 명령을 이용해 칼럼의 데이터 유형, 디폴트 값, NOT NULL 제약 조건에 대해 변경을 포함할 수 있다.
    - ex) ALTER TABLE 테이블명 ALTER(MODIFY) (칼럼명 1 데이터유형 [DEFAULT 식] [NOT NULL], ...)
- RENAME COLUMN : 테이블을 생성하면서 만들어졌던 칼럼명을 어떤 이유로 불가피하게 변경해야 하는 경우에 유용하게 쓰일 수 있는 명령어이다.
    - ex) ALTER TABLE 테이블명 RENAME COLUMN 변경해야 할 칼럼명 TO 새로운 칼럼명
- DROP CONSTRAINT : 테이블 생성 시 부여했던 제약조건을 삭제하는 명령어이다.
    - ex) ALTER TABLE 테이블명 DROP CONSTRAINT 제약조건명
- ADD CONSTRAINT : 테이블 생성 시 제약조건을 적용하지 않았다면, 생성 이후에 필요에 의해서 제약조건을 추가할 수 있다.
    - ex) ALTER TABLE 테이블명 ADD CONSTRAINT 제약조건명 제약조건

#### 4. RENAME TABLE
- RENAME 명령어를 사용하여 테이블의 이름을 변경할 수 있다.
    - ex) RENAME 테이블명 TO 변경할 테이블명

#### 5. DROP TABLE
- 테이블을 잘못 만들었거나 테이블이 더 이상 필요 없을 경우 해당 테이블을 삭제해야 할 때 사용한다.
    - ex) DROP TABLE 테이블명[CASCADE CONSTRAINT] 
    - CASCADE CONSTRAINT : 해당 테이블과 관계가 있었던 참조되는 제약조건에 대해서도 삭제하는 것을 의미한다.

#### 6. TRUNCATE TABLE
- TRUNCATE TABLE은 테이블 자체가 삭제되는 것이 아니고, 해당 테이블에 들어있던 모든 행들이 제거되고 저장 공간을 재사용 가능하도록 해제한다.
    - ex) TRUNCATE TABLE 테이블명

### :speech_balloon: DML

#### 1. INSERT
- 테이블에 데이터를 입력하는 방법은 두 가지 유형이 있으며 한번에 한 건만 입력된다.
    - ex) INSERT INTO 테이블명 (칼럼 명) VALUES (칼럼에 넣을 데이터)
    - ex) INSERT INTO 테이블명VALUES (전체 칼럼에 넣을 데이터)

#### 2. UPDATE
- 입력한 정보 중에 잘못 입력 되거나 변경이 발생하여 정보를 수정해야 하는 경우가 발생할 때 사용한다.
    - ex) UPDATE 테이블명 SET 수정할 칼럼명 = 수정되기를 원하는 새로운 값

#### 3. DELETE
- 테이블의 정보가 필요 없게 되었을 경우 데이터 삭제를 수행한다.
    - ex) DELETE(FROM) 삭제를 원하는 정보가 들어있는 테이블명
- DELETE 보단 TRUNCATE TABLE 사용을 권고한다.

#### 4. SELECT
- 사용자가 입력한 데이터는 언제라도 조회가 가능하다.(DISTINCT 옵션 : 중복된 데이터가 있는 경우 1건으로 처리해서 출력한다.)
    - ex) SELECT 조회할 칼럼들 FROM 테이블명

### :speech_balloon: TCL

#### 1. 트랜잭션 개요
- 트랜잭션은 데이터베이스의 논리적 연산단위이다. 트랜잭션이란 밀접히 관련되어 분리될 수 없는 한 개이상의 데이터베이스 조작을 가리킨다.
- 트랜잭션은 ALL OR NOTHING의 개념이다.
- 트랜잭션의 대상이 되는 SQL문은 DML문이다.
- 트랜잭션의 특성
    - 원자성 : 트랜잭션에서 정의된 연산들은 모두 성공적으로 싱행되던지 아니면 전혀 실행되지 않은 상태로 남아 있어야 한다.
    - 일관성 : 트랜잭션이 실행되기 전의 데이터베이스 내용이 잘못 되어 있지 않다면 트랜잭션이 실행된 이후에도 데이터베이스의 내용에 잘못이 있으면 안 된다.
    - 고립성 : 트랜잭션이 실행되는 도중에 다른 트랜잭션의 영향을 받아 잘못된 결과를 만들어서는 안된다.
    - 지속성 : 트랜잭션이 성공적으로 수행되면 그 트랜잭션이 갱신한 데이터베이스의 내용은 영구적으로 저장된다.

#### 2. COMMIT
- 입력한 자료나 수정한 자료에 대해서 또는 삭제한 자료에 대해서 전혀 문제가 없다고 판단 되었을 경우 COMMIT 명령어를 통해서 트랜잭션을 완료할 수 있다.

#### 3. ROLLBACK
- 테이블 내 입력한 데이터나, 수정한 데이터, 삭제한 데이터에 대하여 COMMIT 이전에는 변경 사항을 취소할 수 있는데 데이터베이스에서는 롤백 기능을 사용한다.

#### 4. SAVEPOINT
- 저장점을 정의하면 롤백 할 때 트랜잭션에 포함된 전체 작업을 롤백하는 것이 아니라 현 시점에서 SAVEPOINT까지 트랜잭션의 일부만 롤백할 수 있다.
    
#### 5. WHERE
- 연산자의 우선순위
    1. 괄호
    2. NOT 연산자
    3. 비교 연산자, SQL 비교 연산자
    4. AND
    5. OR

### :speech_balloon: 함수

#### 1. 내장 함수 개요
- SELECT, WHERE, ORDER BY 절에 사용이 가능하다(단일행 함수) : 각 행들에 대해 개별적으로 작용하여 데이터 값들을 조작하고, 각각의 행에 대한 조작 결과를 리턴한다

#### 2. 문자형 함수
- 문자형 함수는 문자 데이터를 매개 변수로 받아들여서 문자나 숫자 값의 결과를 돌려주는 함수이다.
- 단일행 문자형 함수의 종류
    - CONCAT(arg1, arg2) : arg1과 arg2를 연결한다.
    - SUBSTR/SUBSTRING(문자열, m[, n]) : 문자열 중 m 위치에서 n개의 문자 길이에 해당하는 문자를 돌려준다.

#### 3. 숫자형 함수
- 숫자형 함수는 숫자 데이터를 입력받아 처리하고 숫자를 리턴하는 함수이다.
- 단일행 숫자형 함수의 종류
    - SIGN(숫자) : 숫자가 양수인지, 음수인지 0인지를 구별한다.
    - MOD(숫자1, 숫자2) : 숫자1을 숫자2로 나누어 나머지 값을 리턴한다. % 연산자로도 대체 가능
    - CEIL/CEILING(숫자) : 숫자보다 크거나 같은 최소 정수를 리턴한다.
    - FLOOR(숫자) : 숫자보다 작거나 같은 최대 정수를 리턴한다.
    - TRUNC(숫자 [, m]) : 숫자를 소수 m자리에서 잘라서 버린다.

#### 4. 날짜형 함수
- 날짜형 함수는 DATE 타입의 값을 연산하는 함수이다.
- 단일행 날짜형 함수 종류
    - SYSDATE/GETDATE() : 현재 날짜와 시각을 출력한다.
    - EXTRACT/DATEPART : 날짜 데이터에서 년/월/일 데이터를 출력할 수 있다. 시간/분/초도 가능함
    - TO_NUMBER(TO_CHAR(d, 'YYYY)) : 옵션을 줄 수도 있음

 #### 5. 변환형 함수
- 변환형 함수는 특정 데이터 타입을 다양한 형식으로 출력하고 싶을 경우에 사용되는 함수이다.
- 데이터 유형 변환의 종류
    - 명시적 데이터 유형 변환 : 데이터 변환형 함수로 데이터 유형을 변환하도록 명시해 주는 경우
    - 암시적 데이터 유형 변환 : 데이터베이스가 자동으로 데이터 유형을 변환하여 계산하는 경우

#### 6. CASE 표현
- CASE 표현은 IF-THEN-ELSE 논리와 유사한 바익으로 표현식을 작성해서 SQL의 비교 연산 기능을 보완하는 역할을 한다.
- 단일행 CASE 표현의 종류
    - CASE
        SIMPLE_CASE_EXPRESSION 조건
        ELSE 표현절
      END
#### 7. NULL 관련 함수
- NULL 값을 포함하는 연산의 경우 결과 값도 널 값이다.
- 결과 값을 널이 아닌 다른 값을 얻고자 할 때, NVL/ISNULL 함수를 사용한다.
- 단일행 NULL 관련 함수의 종류
    - NVL(표현식1, 표현식2)/ISNULL(표현식1, 표현식2) : 표현식1의 결과 값이 널이면 표현식2의 값을 출력한다. 단, 표현식1과 표현식2의 결과 데이터 타입이 같아야 한다.
    - NULLIF(표현식1, 표현식2) : 표현식1이 표현식2와 같으면 널을, 같지 않으면 표현식1을 리턴한다.
    - COALESCE(표현식1, 표현식2, ...) : 임의의 개수 표현식에서 널이 아닌 최초의 표현식을 나타낸다. 모든 표현식이 널이라면 널을 리턴한다.

### :speech_balloon: group by, having 절

#### 1. 집계 함수
- 여러 행들의 그룹이 모여서 그룹당 단 하나의 결과를 돌려주는 함수이다.

#### 2. GROUP BY절
- GROUP BY 절은 SQL문에서 FROM 절과 WHERE 절 뒤에 오며, 데이터들은 작은 그룹으로 분류하여 소그룹에 대한 항목별로 통계 정보를 얻을 때 추가로 사용한다.

#### 3. HAVING절
- WHERE에서는 집계 함수를 사용할 수 없다. 그래서 HAVING절을 사용한다.
- 대체로 그루핑 되고 데이터를 집어 넣는게 좋기 때문에 GROUP BY 절을 먼저 작성 후 HAVING을 작성하는 것을 권고한다.

#### 4. CASE 표현을 활용한 월별 데이터 집계
- 모델링의 제 1정규화로 인해 반복되는 칼럼의 경우 구분 칼럼을 두고 여러 개의 레코드로 만들어진 집합을, 정해진 칼럼 수 만큼 확장해서 집계 보고서를 만드는 유용한 기법이다.

### :speech_balloon: ORDER BY 절

#### 1. ORDER BY 정렬
- ORDER BY 절은 SQL 문장으로 조화된 데이터들을 다양한 목적에 맞게 특정 칼럼을 기준으로 정렬하여 출력하는데 사용한다.

#### 2. SELECT 문장 실행 순서
- 테이블을 참조한다(FROM) -> 발췌 대상 데이터가 아닌 것은 제거한다(WHERE) -> 행들을 소그룹화 한다(GROUP BY) -> 그룹핑 된 값의 조건에 맞는 것만을 출력한다(HAVING) -> 데이터 값을 출력/계산한다(SELECT) -> 데이터를 정렬한다(ORDER BY)

#### 3. TOP N 쿼리
- ROWNUM : 순위가 높은 N개의 로우를 추출하기 위해 ORDER BY 절과 WHERE 절의 ROWNUM 조건을 같이 사용하는 경우가 있는데 이 두 조건으로는 원하는 결과를 얻을 수 없다.
- TOP() : 반면 SQL 서버는 TOP 조건을 사용하게 되면 별도 처리 없이 관련 ORDEY BY 절의 데이터 정렬 후 원하는 일부 데이터만 쉽게 출력할 수 있다.

### :speech_balloon: JOIN

#### 1. JOIN 개요
- 두 개 이상의 테이블들을 연결 또는 결합하여 데이터를 출력하는 것
- 조인은 관계형 데이터베이스의 가장 큰 장점이면서 대표적인 핵심 기능이라고 할 수 있다.

#### 2. EQUI JOIN
- EQUI(등가) 조인은 두 개의 테이블 간에 칼럼 값들이 서로 정확하게 일치하는 경우에 사용되는 방법으로 대부분 PK <-> FK의 관계를 기반으로 한다.

#### 3. Non EQUI JOIN
- 비등가 조인은 두 개의 테이블 간에 칼럼 값들이 서로 정확하게 일치하지 않는 경우에 사용된다.
